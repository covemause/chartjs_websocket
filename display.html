<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.22.2/moment.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.7.3/Chart.min.js"></script>
    <script src="https://github.com/nagix/chartjs-plugin-streaming/releases/download/v1.7.1/chartjs-plugin-streaming.min.js"></script>
</head>
<body>
<canvas id="myChart"></canvas>
<script>
var ctx = document.getElementById('myChart').getContext('2d');
var chart = new Chart(ctx, {
        type: 'line',
        data: {
            datasets: [{
                label:'気温',
                data: [],
                backgroundColor: "rgba(255,229,153,0.4)",
                borderColor: "rgba(203,10,10,1)"
            }, {
                label:'湿度',
                data: [],
                backgroundColor: "rgba(	153,204,255,0.4)",
                borderColor: "rgba(0,127,255,1)"
            }]
        },
            options: {
                scales: {
                    xAxes: [{
                        type: 'realtime'
                    }]
                }
            } 
        });

// server IP : 192.168.1.1
var connection = new WebSocket('ws://192.168.1.1:8080/ws/display');
connection.onmessage = function (e) {
    chart.data.datasets[0].data.push(
        {
            x: JSON.parse(e.data)["time"],
            y: JSON.parse(e.data)["Temperature"]
        }
    );
    chart.data.datasets[1].data.push(
        {
            x: JSON.parse(e.data)["time"],
            y: JSON.parse(e.data)["Humidity"]
        }
    );
    chart.update();
};
</script>
</body>
</html>
